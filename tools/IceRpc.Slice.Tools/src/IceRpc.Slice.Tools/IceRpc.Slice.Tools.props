<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) ZeroC, Inc. -->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <EnableDefaultSliceCItems Condition="'$(EnableDefaultSliceCItems)' == ''">true</EnableDefaultSliceCItems>
        <!-- Workaround for Omnisharp not setting $(Configuration) property when loading C# projects -->
        <BuildConfiguration>$(Configuration)</BuildConfiguration>
        <BuildConfiguration Condition="'$(BuildConfiguration)' == ''">Debug</BuildConfiguration>
    </PropertyGroup>
    <Choose>
        <When Condition="Exists('$(MSBuildThisFileDirectory)..\..\..\slicec-cs')">
            <!-- Use Slice files and Slice compiler from this source build -->
            <PropertyGroup>
                <SliceCompilerPath Condition="'$(BuildConfiguration)' == 'Debug'">$(MSBuildThisFileDirectory)..\..\..\slicec-cs\target\debug</SliceCompilerPath>
                <SliceCompilerPath Condition="'$(BuildConfiguration)' == 'Release'">$(MSBuildThisFileDirectory)..\..\..\slicec-cs\target\release</SliceCompilerPath>
                <SliceBuiltInFilesPath>$(MSBuildThisFileDirectory)..\..\..\..\slice</SliceBuiltInFilesPath>
            </PropertyGroup>
        </When>
        <Otherwise>
            <!-- Use Slice files and Slice compiler from this NuGet package -->
            <PropertyGroup>
                <SliceCompilerPath>$(MSBuildThisFileDirectory)..\tools</SliceCompilerPath>
                <SliceBuiltInFilesPath>$(MSBuildThisFileDirectory)..\slice</SliceBuiltInFilesPath>
            </PropertyGroup>
        </Otherwise>
    </Choose>

    <Choose>
        <When Condition="Exists('$(MSBuildThisFileDirectory)bin\$(BuildConfiguration)\netstandard2.0\IceRpc.Slice.Tools.dll')">
            <PropertyGroup>
                <SliceToolsTaskAssembliesPath>$(MSBuildThisFileDirectory)bin\$(BuildConfiguration)\netstandard2.0\</SliceToolsTaskAssembliesPath>
            </PropertyGroup>
        </When>
        <Otherwise>
            <PropertyGroup>
                <SliceToolsTaskAssembliesPath>$(MSBuildThisFileDirectory)..\tasks\</SliceToolsTaskAssembliesPath>
            </PropertyGroup>
        </Otherwise>
    </Choose>
    <!-- default values -->
    <ItemDefinitionGroup>
        <SliceC>
            <OutputDir>$(MSBuildProjectDirectory)\generated</OutputDir>
        </SliceC>
    </ItemDefinitionGroup>
</Project>
